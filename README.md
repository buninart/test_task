# Тестовое задание: Конфигурирование Ubuntu 22.04 VM под PCI DSS с использованием Ansible

## Описание
Настройка вм Ubuntu 22.04 LTS, которая должна соответствовать минимальным требованиям PCI DSS. Все настройки выполняются с использованием Ansible.
Проект включает две роли: `base_hardening` (базовая настройка безопасности для всех серверов) и `app_role` (настройка приложения).

## Требования

- ОС: Ubuntu 22.04 LTS
- Ansible: версия 2.9+ (протестировано с 2.9.6)
- Python: версия 3.8+
- Доступ к удаленному серверу или виртуальной машине для выполнения плейбуков

## Структура проекта

- site.yml - основной плейбук, который вызывает роли `base_hardening` и `app_role`.
- inventory - файл для указания целевых хостов.
- roles/base_hardening - роль для базовой настройки безопасности.
  - tasks - задачи для настройки серверов.
  - templates - шаблоны для конфигураций
  - handlers - обработчики для перезагрузки сервисов.
- roles/app_role - роль для настройки приложения 
  - tasks - задачи для настройки приложения.
  - templates - шаблон systemd unit-файла для приложения.

## Настройки безопасности (base_hardening)

1. Firewall:
   - Использование `ufw` для ограничения входящего трафика.
   - Разрешены только порты для SSH (22).

2. SSH:
   - Отключен доступ по паролю, разрешен только доступ по ключу.
   - Слабые шифры и алгоритмы отключены.

3. Учётные записи:
   - Заблокированы неиспользуемые системные аккаунты.
   - Нет пользователей с пустыми паролями.

4. Логирование и аудит:
   - Настроен `auditd` для отслеживания событий (изменения в конфигурационных файлах, попытки авторизации).
   - Ротация логов.

5. Пакеты и сервисы:
   - Удалены небезопасные пакеты (`telnet`, `ftp`, и другие).
   - Включены автоматические обновления безопасности.

6. Время:
   - Установлен и настроен `chrony` для синхронизации времени.

7. Sysctl:
   - Применены настройки безопасности для сетевого стека.

## Настройки приложения (app_role)

1. Пользователь приложения:
   - Создан пользователь `appuser`.

2. Директории:
   - Созданы директории для приложения: `/var/lib/app/`, `/var/log/app/`.

3. Systemd unit:
   - Создан systemd unit-файл для управления сервисом приложения.

4. Открытие порта:
   - Открыт порт 8080 через `ufw` для приложения.

## Запуск

1. Склонируйте репозиторий:
   git clone https://github.com/buninart/test_task.git
   cd test_task

2. Настройте inventory файл для указания хостов.

3. Запустите плейбук:
ansible-playbook site.yml -i inventory --private-key=path/to/your/private/key
